<?xml version="1.0"?>

<custom-sql>
	<sql id="com.liferay.jbpm.db.GraphSession.countProcessDefinitionsByName">
		<![CDATA[
			SELECT
				COUNT(*) AS COUNT_VALUE
			FROM
				org.jbpm.graph.def.ProcessDefinition AS pd
			WHERE
				lower(pd.name) LIKE :name
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.countProcessInstancesBySearchTerms">
		<![CDATA[
			SELECT
				COUNT(DISTINCT JBPM_PROCESSINSTANCE.ID_) AS COUNT_VALUE
			FROM
				JBPM_PROCESSINSTANCE
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			[$ASSIGNED_USER_ID_INNER_JOIN$]
			WHERE
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(JBPM_PROCESSDEFINITION.VERSION_ = ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_PROCESSINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_PROCESSINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$ASSIGNED_USER_ID_CHECK$]
				[$END_DATE_CHECK$]
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.countTaskInstancesByActor">
		<![CDATA[
			SELECT
				COUNT(DISTINCT JBPM_TASKINSTANCE.ID_) AS COUNT_VALUE
			FROM
				JBPM_TASKINSTANCE
			INNER JOIN
				JBPM_TOKEN ON
					JBPM_TOKEN.ID_ = JBPM_TASKINSTANCE.TOKEN_
			INNER JOIN
				JBPM_PROCESSINSTANCE ON JBPM_PROCESSINSTANCE.ID_ = JBPM_TOKEN.PROCESSINSTANCE_
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			WHERE
			(
				(lower(JBPM_TASKINSTANCE.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.CREATE_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.CREATE_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$END_DATE_CHECK$]
			) AND
			(JBPM_TASKINSTANCE.ACTORID_ = ?)
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.countTaskInstancesByPool">
		<![CDATA[
			SELECT
				COUNT(DISTINCT JBPM_TASKINSTANCE.ID_) AS COUNT_VALUE
			FROM
				JBPM_POOLEDACTOR
			INNER JOIN
				JBPM_TASKACTORPOOL ON JBPM_POOLEDACTOR.ID_ = JBPM_TASKACTORPOOL.POOLEDACTOR_
			INNER JOIN
				JBPM_TASKINSTANCE ON JBPM_TASKINSTANCE.ID_ = JBPM_TASKACTORPOOL.TASKINSTANCE_
			INNER JOIN
				JBPM_TOKEN ON JBPM_TOKEN.ID_ = JBPM_TASKINSTANCE.TOKEN_
			INNER JOIN
				JBPM_PROCESSINSTANCE ON JBPM_PROCESSINSTANCE.ID_ = JBPM_TOKEN.PROCESSINSTANCE_
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			WHERE
			(
				(lower(JBPM_TASKINSTANCE.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.CREATE_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.CREATE_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$END_DATE_CHECK$]
			) AND
			(JBPM_POOLEDACTOR.ACTORID_ = ? AND JBPM_TASKINSTANCE.ACTORID_ IS NULL)
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.findProcessDefinitionsByName">
		<![CDATA[
			SELECT
				pd
			FROM
				org.jbpm.graph.def.ProcessDefinition AS pd
			WHERE
				lower(pd.name) LIKE :name
			ORDER BY
				pd.name,
				pd.version DESC
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.findProcessInstancesBySearchTerms">
		<![CDATA[
			SELECT
				DISTINCT (JBPM_PROCESSINSTANCE.ID_) AS instanceId, JBPM_PROCESSINSTANCE.START_ AS instanceStart, JBPM_PROCESSDEFINITION.NAME_ AS definitionName
			FROM
				JBPM_PROCESSINSTANCE
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			[$ASSIGNED_USER_ID_INNER_JOIN$]
			WHERE
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(JBPM_PROCESSDEFINITION.VERSION_ = ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_PROCESSINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_PROCESSINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$ASSIGNED_USER_ID_CHECK$]
				[$END_DATE_CHECK$]
			ORDER BY
				JBPM_PROCESSDEFINITION.NAME_,
				JBPM_PROCESSINSTANCE.START_ DESC
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.findTaskInstancesByActor">
		<![CDATA[
			SELECT
				DISTINCT (JBPM_TASKINSTANCE.ID_) AS taskId, JBPM_TASKINSTANCE.ACTORID_ AS taskActorId, JBPM_TASKINSTANCE.CREATE_ AS taskCreate
			FROM
				JBPM_TASKINSTANCE
			INNER JOIN
				JBPM_TOKEN ON
					JBPM_TOKEN.ID_ = JBPM_TASKINSTANCE.TOKEN_
			INNER JOIN
				JBPM_PROCESSINSTANCE ON JBPM_PROCESSINSTANCE.ID_ = JBPM_TOKEN.PROCESSINSTANCE_
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			WHERE
			(
				(lower(JBPM_TASKINSTANCE.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.CREATE_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.CREATE_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$END_DATE_CHECK$]
			) AND
			(JBPM_TASKINSTANCE.ACTORID_ = ?)
		]]>
	</sql>
	<sql id="com.liferay.jbpm.db.GraphSession.findTaskInstancesByPool">
		<![CDATA[
			SELECT
				DISTINCT (JBPM_TASKINSTANCE.ID_) AS taskId, JBPM_TASKINSTANCE.ACTORID_ AS taskActorId, JBPM_TASKINSTANCE.CREATE_ AS taskCreate
			FROM
				JBPM_POOLEDACTOR
			INNER JOIN
				JBPM_TASKACTORPOOL ON JBPM_POOLEDACTOR.ID_ = JBPM_TASKACTORPOOL.POOLEDACTOR_
			INNER JOIN
				JBPM_TASKINSTANCE ON JBPM_TASKINSTANCE.ID_ = JBPM_TASKACTORPOOL.TASKINSTANCE_
			INNER JOIN
				JBPM_TOKEN ON JBPM_TOKEN.ID_ = JBPM_TASKINSTANCE.TOKEN_
			INNER JOIN
				JBPM_PROCESSINSTANCE ON JBPM_PROCESSINSTANCE.ID_ = JBPM_TOKEN.PROCESSINSTANCE_
			INNER JOIN
				JBPM_PROCESSDEFINITION ON JBPM_PROCESSDEFINITION.ID_ = JBPM_PROCESSINSTANCE.PROCESSDEFINITION_
			WHERE
			(
				(lower(JBPM_TASKINSTANCE.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				(lower(JBPM_PROCESSDEFINITION.NAME_) LIKE ? [$AND_OR_NULL_CHECK$]) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.CREATE_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.CREATE_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				((JBPM_TASKINSTANCE.START_ >= ? [$AND_OR_NULL_CHECK$]) AND (JBPM_TASKINSTANCE.START_ <= ? [$AND_OR_NULL_CHECK$])) [$AND_OR_CONNECTOR$]
				[$END_DATE_CHECK$]
			) AND
			(JBPM_POOLEDACTOR.ACTORID_ = ? AND JBPM_TASKINSTANCE.ACTORID_ IS NULL)
		]]>
	</sql>
</custom-sql>